<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scam Hunter - –î–µ—Ç–µ–∫—Ç–∏–≤ –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366F1;
            --primary-dark: #4F46E5;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --background: #0F172A;
            --surface: #1E293B;
            --surface-light: #334155;
            --text-primary: #F1F5F9;
            --text-secondary: #94A3B8;
            --border: #334155;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .app-container {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--background) 0%, #1E1B4B 100%);
        }

        .screen {
            display: none;
            min-height: 100vh;
        }

        .screen.active {
            display: block;
        }

        /* –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ */
        #loadingScreen {
            background: linear-gradient(135deg, var(--background) 0%, #1E1B4B 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .loading-content {
            text-align: center;
            padding: 2rem;
        }

        .loader-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: bounce 1.5s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .game-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .loading-subtitle {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .progress-bar {
            width: 200px;
            height: 6px;
            background: var(--surface);
            border-radius: 3px;
            overflow: hidden;
            margin: 0 auto;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), #8B5CF6);
            border-radius: 3px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é */
        .menu-header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--background) 100%);
            padding: 2rem 1.5rem 1.5rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .main-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .user-info {
            background: var(--surface);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            margin-top: 1rem;
            display: inline-block;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .menu-content {
            padding: 1.5rem;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem 0.5rem;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-icon {
            font-size: 1.3rem;
            margin-bottom: 0.3rem;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.2rem;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .player-badge {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 50px;
            padding: 0.6rem 1.2rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0 auto 1.5rem;
            justify-content: center;
        }

        .badge-emoji {
            font-size: 1.1rem;
        }

        .badge-text {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            padding: 1rem 1.2rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }

        .btn-primary:active {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:active {
            background: var(--surface-light);
            transform: translateY(1px);
        }

        .btn-telegram {
            background: #0088cc;
            color: white;
            border: none;
        }

        .btn-telegram:active {
            background: #0077b3;
            transform: translateY(1px);
        }

        .btn-icon {
            font-size: 1.1rem;
        }

        .progress-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.2rem;
            margin-bottom: 1rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .progress-text {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .progress-bar.large {
            width: 100%;
            height: 6px;
        }

        .telegram-actions {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ —ç–∫—Ä–∞–Ω–æ–≤ */
        .screen-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .back-btn {
            background: var(--surface-light);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 0.6rem 0.8rem;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .back-btn.small {
            padding: 0.4rem;
        }

        .back-btn:active {
            background: var(--border);
            transform: scale(0.95);
        }

        .screen-title {
            font-size: 1.3rem;
            font-weight: 600;
            text-align: center;
            flex: 1;
        }

        .header-spacer {
            width: 40px;
        }

        /* –≠–∫—Ä–∞–Ω –∫–µ–π—Å–æ–≤ */
        .cases-container {
            padding: 1.5rem;
        }

        .cases-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.8rem;
        }

        .case-item {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.2rem 0.8rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .case-item:active {
            transform: scale(0.95);
        }

        .case-item.completed {
            border-color: var(--success);
            background: linear-gradient(135deg, var(--surface), rgba(16, 185, 129, 0.1));
        }

        .case-item.current {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--surface), rgba(99, 102, 241, 0.1));
            box-shadow: 0 0 0 2px var(--primary);
        }

        .case-item.locked {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .case-number {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.4rem;
            color: var(--text-primary);
        }

        .case-difficulty {
            font-size: 0.7rem;
            padding: 0.2rem 0.4rem;
            border-radius: 6px;
            font-weight: 500;
        }

        .difficulty-beginner { background: rgba(16, 185, 129, 0.2); color: #10B981; }
        .difficulty-intermediate { background: rgba(245, 158, 11, 0.2); color: #F59E0B; }
        .difficulty-advanced { background: rgba(239, 68, 68, 0.2); color: #EF4444; }
        .difficulty-expert { background: rgba(139, 92, 246, 0.2); color: #8B5CF6; }

        /* –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω */
        .game-header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 1rem 1.5rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .case-header {
            display: flex;
            align-items: flex-start;
            gap: 0.8rem;
            margin-bottom: 0.8rem;
        }

        .case-info {
            flex: 1;
        }

        .case-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: var(--text-primary);
        }

        .case-meta {
            display: flex;
            gap: 0.6rem;
            align-items: center;
        }

        .difficulty-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .case-number {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .game-stats {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .game-stat {
            text-align: center;
        }

        .stat-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.2rem;
        }

        .game-content {
            padding: 1.5rem;
        }

        .dialogue-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.2rem;
            margin-bottom: 1rem;
        }

        .message-text {
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-bottom: 1rem;
        }

        .choice-btn {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem 0.8rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .choice-btn:active {
            background: var(--surface-light);
            transform: scale(0.98);
        }

        .feedback-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.2rem;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .feedback-card.show {
            display: block;
            animation: slideUp 0.3s ease;
        }

        .feedback-card.hidden {
            display: none;
        }

        .feedback-content.correct {
            border-left: 4px solid var(--success);
        }

        .feedback-content.partial {
            border-left: 4px solid var(--warning);
        }

        .feedback-content.incorrect {
            border-left: 4px solid var(--error);
        }

        .feedback-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.8rem;
        }

        .feedback-icon {
            font-size: 1.1rem;
        }

        .feedback-title {
            font-weight: 600;
            font-size: 1rem;
        }

        .feedback-text {
            line-height: 1.4;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .next-case-btn {
            margin-top: 1rem;
            width: 100%;
        }

        /* –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .stats-container {
            padding: 1.5rem;
        }

        .stats-grid {
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }

        .stat-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.2rem;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.8rem;
            color: var(--text-primary);
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0;
            border-bottom: 1px solid var(--border);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-name {
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .stat-value {
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* –≠–∫—Ä–∞–Ω –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
        .achievements-container {
            padding: 1.5rem;
        }

        .achievements-grid {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .achievement-item {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .achievement-item.unlocked {
            border-color: var(--success);
            background: linear-gradient(135deg, var(--surface), rgba(16, 185, 129, 0.1));
        }

        .achievement-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .achievement-info {
            flex: 1;
        }

        .achievement-name {
            font-weight: 600;
            margin-bottom: 0.2rem;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .achievement-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .achievement-status {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .cases-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-cards {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .game-header {
                flex-direction: column;
                gap: 0.8rem;
            }
            
            .game-stats {
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .cases-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
                gap: 0.6rem;
            }
            
            .menu-content {
                padding: 1rem;
            }
            
            .cases-container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loadingScreen" class="screen">
            <div class="loading-content">
                <div class="loader">
                    <div class="loader-icon">üïµÔ∏è‚Äç‚ôÇÔ∏è</div>
                    <h1 class="game-title">Scam Hunter</h1>
                    <p class="loading-subtitle">–ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞—â–∏—Ç—É –æ—Ç –º–æ—à–µ–Ω–Ω–∏–∫–æ–≤...</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="loadingProgress"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="mainMenu" class="screen active">
            <div class="menu-header">
                <h1 class="main-title">üïµÔ∏è‚Äç‚ôÇÔ∏è Scam Hunter</h1>
                <p class="subtitle">–°—Ç–∞–Ω—å –¥–µ—Ç–µ–∫—Ç–∏–≤–æ–º –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞</p>
                <div class="user-info" id="userInfo">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è...
                </div>
            </div>

            <div class="menu-content">
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalScore">0</div>
                            <div class="stat-label">–û—á–∫–∏</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-info">
                            <div class="stat-value" id="accuracy">0%</div>
                            <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üî•</div>
                        <div class="stat-info">
                            <div class="stat-value" id="streak">0</div>
                            <div class="stat-label">–°–µ—Ä–∏—è</div>
                        </div>
                    </div>
                </div>

                <div class="player-badge" id="playerBadge">
                    <span class="badge-emoji">üü¢</span>
                    <span class="badge-text">–ù–æ–≤–∏—á–æ–∫</span>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" id="startGameBtn">
                        <span class="btn-icon">üéÆ</span>
                        –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É
                    </button>
                    <button class="btn btn-secondary" id="casesBtn">
                        <span class="btn-icon">üìö</span>
                        –í—Å–µ –∫–µ–π—Å—ã
                    </button>
                    <button class="btn btn-secondary" id="statsBtn">
                        <span class="btn-icon">üìä</span>
                        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                    </button>
                    <button class="btn btn-secondary" id="achievementsBtn">
                        <span class="btn-icon">üèÜ</span>
                        –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                    </button>
                </div>

                <div class="progress-section">
                    <div class="progress-header">
                        <span>–ü—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã</span>
                        <span class="progress-text" id="progressText">0/100</span>
                    </div>
                    <div class="progress-bar large">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <div class="telegram-actions">
                    <button class="btn btn-telegram" id="shareBtn">
                        <span class="btn-icon">üì§</span>
                        –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∫–µ–π—Å–æ–≤ -->
        <div id="casesScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" id="backFromCasesBtn">
                    <span>‚Üê –ù–∞–∑–∞–¥</span>
                </button>
                <h2 class="screen-title">üìö –í—Å–µ –∫–µ–π—Å—ã</h2>
                <div class="header-spacer"></div>
            </div>
            <div class="cases-container">
                <div class="cases-grid" id="casesGrid">
                    <!-- –ö–µ–π—Å—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="gameScreen" class="screen">
            <div class="game-header">
                <div class="case-header">
                    <button class="back-btn small" id="backFromGameBtn">
                        <span>‚Üê</span>
                    </button>
                    <div class="case-info">
                        <h3 class="case-title" id="caseTitle">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–µ–π—Å–∞...</h3>
                        <div class="case-meta">
                            <span class="difficulty-badge" id="caseDifficulty">–ù–æ–≤–∏—á–æ–∫</span>
                            <span class="case-number" id="caseNumber">#1</span>
                        </div>
                    </div>
                </div>
                <div class="game-stats">
                    <div class="game-stat">
                        <span class="stat-label">–û—á–∫–∏:</span>
                        <span class="stat-value" id="currentScore">0</span>
                    </div>
                    <div class="game-stat">
                        <span class="stat-label">–°–µ—Ä–∏—è:</span>
                        <span class="stat-value" id="currentStreak">0</span>
                    </div>
                </div>
            </div>

            <div class="game-content">
                <div class="dialogue-card">
                    <div class="message-content">
                        <div class="message-text" id="dialogueText">
                            –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–∞–ª–æ–≥–∞...
                        </div>
                    </div>
                </div>

                <div class="choices-container" id="choicesContainer">
                    <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>

                <div class="feedback-card hidden" id="feedbackContainer">
                    <div class="feedback-content" id="feedbackContent">
                        <div class="feedback-header">
                            <span class="feedback-icon" id="feedbackIcon">üí°</span>
                            <span class="feedback-title" id="feedbackTitle">–†–µ–∑—É–ª—å—Ç–∞—Ç</span>
                        </div>
                        <div class="feedback-text" id="feedbackText">
                            –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...
                        </div>
                        <button class="btn btn-primary next-case-btn hidden" id="nextCaseBtn">
                            <span class="btn-icon">‚û°Ô∏è</span>
                            –°–ª–µ–¥—É—é—â–∏–π –∫–µ–π—Å
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div id="statsScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" id="backFromStatsBtn">
                    <span>‚Üê –ù–∞–∑–∞–¥</span>
                </button>
                <h2 class="screen-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                <div class="header-spacer"></div>
            </div>
            <div class="stats-container">
                <div class="stats-grid">
                    <div class="stat-section">
                        <h3 class="section-title">–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                        <div class="stat-item">
                            <span class="stat-name">–í—Å–µ–≥–æ –æ—á–∫–æ–≤</span>
                            <span class="stat-value" id="statTotalScore">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">–ü—Ä–æ–π–¥–µ–Ω–æ –∫–µ–π—Å–æ–≤</span>
                            <span class="stat-value" id="statCasesCompleted">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">–¢–æ—á–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤</span>
                            <span class="stat-value" id="statAccuracy">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">–ú–∞–∫—Å. —Å–µ—Ä–∏—è</span>
                            <span class="stat-value" id="statMaxStreak">0</span>
                        </div>
                    </div>

                    <div class="stat-section">
                        <h3 class="section-title">–ü–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</h3>
                        <div class="stat-item">
                            <span class="stat-name">üü¢ –ù–æ–≤–∏—á–æ–∫</span>
                            <span class="stat-value" id="statBeginner">0/20</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">üü° –°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="stat-value" id="statIntermediate">0/30</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">üî¥ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</span>
                            <span class="stat-value" id="statAdvanced">0/30</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">üü£ –≠–∫—Å–ø–µ—Ä—Ç</span>
                            <span class="stat-value" id="statExpert">0/20</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
        <div id="achievementsScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" id="backFromAchievementsBtn">
                    <span>‚Üê –ù–∞–∑–∞–¥</span>
                </button>
                <h2 class="screen-title">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                <div class="header-spacer"></div>
            </div>
            <div class="achievements-container">
                <div class="achievements-grid" id="achievementsGrid">
                    <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞
        const BOT_TOKEN = '8405535827:AAFT8rUZeRUxsv_0_PiwSr25B9UCL2-kE0U';

        class ScamHunterGame {
            constructor() {
                this.playerData = this.loadPlayerData();
                this.cases = this.generateCases();
                this.currentCase = null;
                this.currentNode = null;
                this.currentChoice = null;
                this.init();
            }

            init() {
                console.log('üöÄ –ò–≥—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è...');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è –ª–∏ —É–∂–µ –∑–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —ç–∫—Ä–∞–Ω
                if (this.playerData.firstLaunch === undefined || this.playerData.firstLaunch === true) {
                    // –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                    this.playerData.firstLaunch = false;
                    this.savePlayerData();
                    this.showScreen('loadingScreen');
                    this.simulateLoading();
                } else {
                    // –£–∂–µ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å - —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
                    this.initTelegramUser();
                    this.showMainMenu();
                    this.setupEventListeners();
                }
            }

            simulateLoading() {
                let progress = 0;
                const progressBar = document.getElementById('loadingProgress');
                const interval = setInterval(() => {
                    progress += 10;
                    progressBar.style.width = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => {
                            this.initTelegramUser();
                            this.showMainMenu();
                            this.setupEventListeners();
                            console.log('‚úÖ –ò–≥—Ä–∞ –≥–æ—Ç–æ–≤–∞!');
                        }, 300);
                    }
                }, 50);
            }

            initTelegramUser() {
                const user = tg.initDataUnsafe?.user;
                const userInfo = document.getElementById('userInfo');
                
                if (user) {
                    userInfo.innerHTML = `üë§ ${user.first_name}${user.username ? ` (@${user.username})` : ''}`;
                } else {
                    userInfo.innerHTML = 'üë§ –ì–æ—Å—Ç—å';
                }
            }

            setupEventListeners() {
                // –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.getElementById('startGameBtn').addEventListener('click', () => this.startGame());
                document.getElementById('casesBtn').addEventListener('click', () => this.showCasesScreen());
                document.getElementById('statsBtn').addEventListener('click', () => this.showStatsScreen());
                document.getElementById('achievementsBtn').addEventListener('click', () => this.showAchievementsScreen());
                
                // –ö–Ω–æ–ø–∫–∏ –Ω–∞–∑–∞–¥
                document.getElementById('backFromCasesBtn').addEventListener('click', () => this.showMainMenu());
                document.getElementById('backFromGameBtn').addEventListener('click', () => this.showMainMenu());
                document.getElementById('backFromStatsBtn').addEventListener('click', () => this.showMainMenu());
                document.getElementById('backFromAchievementsBtn').addEventListener('click', () => this.showMainMenu());
                
                // –ö–Ω–æ–ø–∫–∏ Telegram
                document.getElementById('shareBtn').addEventListener('click', () => this.shareResults());
                document.getElementById('nextCaseBtn').addEventListener('click', () => this.nextCase());
            }

            loadPlayerData() {
                const saved = localStorage.getItem('scamHunterData');
                if (saved) {
                    return JSON.parse(saved);
                }
                
                const defaultData = {
                    totalScore: 0,
                    completedCases: [],
                    accuracy: 0,
                    currentStreak: 0,
                    maxStreak: 0,
                    stats: {
                        beginner: { completed: 0, correct: 0 },
                        intermediate: { completed: 0, correct: 0 },
                        advanced: { completed: 0, correct: 0 },
                        expert: { completed: 0, correct: 0 }
                    },
                    achievements: [],
                    lastPlayedCase: null,
                    firstLaunch: true
                };
                
                localStorage.setItem('scamHunterData', JSON.stringify(defaultData));
                return defaultData;
            }

            savePlayerData() {
                localStorage.setItem('scamHunterData', JSON.stringify(this.playerData));
            }

            generateCases() {
                const cases = [];
                
                // –£—Ä–æ–≤–Ω–∏ 1-20: –ù–æ–≤–∏—á–æ–∫ - —Å–ª–æ–∂–Ω—ã–µ –∫–µ–π—Å—ã
                for (let i = 1; i <= 20; i++) {
                    cases.push(this.createBeginnerCase(i));
                }
                
                // –£—Ä–æ–≤–Ω–∏ 21-50: –°—Ä–µ–¥–Ω–∏–π
                for (let i = 21; i <= 50; i++) {
                    cases.push(this.createIntermediateCase(i));
                }
                
                // –£—Ä–æ–≤–Ω–∏ 51-80: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π
                for (let i = 51; i <= 80; i++) {
                    cases.push(this.createAdvancedCase(i));
                }
                
                // –£—Ä–æ–≤–Ω–∏ 81-100: –≠–∫—Å–ø–µ—Ä—Ç
                for (let i = 81; i <= 100; i++) {
                    cases.push(this.createExpertCase(i));
                }
                
                return cases;
            }

            createBeginnerCase(id) {
                const scenarios = [
                    {
                        title: "–ö—Ä–∏–ø—Ç–æ-–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏",
                        dialogue: {
                            start: "node_1",
                            nodes: {
                                "node_1": {
                                    question: "üíº –í Telegram-–∫–∞–Ω–∞–ª–µ —Å 50K –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ '—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–ø—Ä–æ–µ–∫—Ç' —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é 300% –≤ –º–µ—Å—è—Ü. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∫–∞–Ω–∞–ª–∞ –ª–∏—á–Ω–æ –ø–∏—à–µ—Ç –≤–∞–º –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç '—ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —É—Å–ª–æ–≤–∏—è'. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç–µ?",
                                    choices: [
                                        {
                                            text: "üí∞ –ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å 10,000‚ÇΩ - —Ç–∞–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å —Ä–µ–¥–∫–æ –±—ã–≤–∞–µ—Ç",
                                            feedback: "‚ùå –û–ø–∞—Å–Ω–æ! –≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø–∏—Ä–∞–º–∏–¥–∞. –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ–∫–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å - –≥–ª–∞–≤–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞. –ù–∞—Å—Ç–æ—è—â–∏–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤—Å–µ–≥–¥–∞ —Å–≤—è–∑–∞–Ω—ã —Å —Ä–∏—Å–∫–æ–º.",
                                            points: 0,
                                            correct: false,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üîç –ò–∑—É—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç: white paper, –∫–æ–º–∞–Ω–¥–∞, roadmap",
                                            feedback: "‚úÖ –í–µ—Ä–Ω–æ! –ü–µ—Ä–µ–¥ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º–∏ –≤—Å–µ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å due diligence. –ù–∞—Å—Ç–æ—è—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –∏–º–µ—é—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—É—é –∫–æ–º–∞–Ω–¥—É.",
                                            points: 15,
                                            correct: true,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üìà –í–ª–æ–∂–∏—Ç—å –Ω–µ–±–æ–ª—å—à—É—é —Å—É–º–º—É '–Ω–∞ –ø—Ä–æ–±—É'",
                                            feedback: "‚ö†Ô∏è –†–∏—Å–∫–æ–≤–∞–Ω–Ω–æ! –ú–æ—à–µ–Ω–Ω–∏–∫–∏ —á–∞—Å—Ç–æ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã–µ –Ω–µ–±–æ–ª—å—à–∏–µ —Å—É–º–º—ã, —á—Ç–æ–±—ã –∑–∞–º–∞–Ω–∏—Ç—å –Ω–∞ –∫—Ä—É–ø–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏.",
                                            points: 5,
                                            correct: false,
                                            next_node: "end"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    {
                        title: "–†–∞–±–æ—Ç–∞ —Å –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–æ–π",
                        dialogue: {
                            start: "node_1",
                            nodes: {
                                "node_1": {
                                    question: "üíº –í–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç —É–¥–∞–ª–µ–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π 150,000‚ÇΩ –≤ –º–µ—Å—è—Ü. –î–ª—è '–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è' –Ω—É–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å '—Å—Ç—Ä–∞—Ö–æ–≤–æ–π –¥–µ–ø–æ–∑–∏—Ç' –≤ 15,000‚ÇΩ, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—É—Ç –ø–æ—Å–ª–µ –∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å—Ä–æ–∫–∞. –†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã. –í–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è?",
                                    choices: [
                                        {
                                            text: "üí≥ –û–ø–ª–∞—Ç–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç - –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç –Ω–∞—Å—Ç–æ—è—â–∏–º–∏",
                                            feedback: "‚ùå –û–ø–∞—Å–Ω–æ! –ù–∞—Å—Ç–æ—è—â–∏–µ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–µ—Ä—É—Ç –¥–µ–Ω—å–≥–∏ —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤. –≠—Ç–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞ —Å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º.",
                                            points: 0,
                                            correct: false,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üè¢ –ü–æ–∑–≤–æ–Ω–∏—Ç—å –≤ –∫–æ–º–ø–∞–Ω–∏—é –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º—É –Ω–æ–º–µ—Ä—É",
                                            feedback: "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã. –ù–∞—Å—Ç–æ—è—â–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø—Ä–µ–¥–æ–ø–ª–∞—Ç.",
                                            points: 12,
                                            correct: true,
                                            next_node: "end"
                                        },
                                        {
                                            text: "ü§ù –°–æ–≥–ª–∞—Å–∏—Ç—å—Å—è, –Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç—å —Å–∫–∏–¥–∫—É –Ω–∞ –¥–µ–ø–æ–∑–∏—Ç",
                                            feedback: "‚ö†Ô∏è –í—Å–µ —Ä–∞–≤–Ω–æ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ! –õ—é–±–∞—è –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –∑–∞ —Ä–∞–±–æ—Ç—É - –ø—Ä–∏–∑–Ω–∞–∫ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞.",
                                            points: 3,
                                            correct: false,
                                            next_node: "end"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    {
                        title: "–§–∏—à–∏–Ω–≥ –æ—Ç '–±–∞–Ω–∫–∞'",
                        dialogue: {
                            start: "node_1",
                            nodes: {
                                "node_1": {
                                    question: "üè¶ –ü—Ä–∏—à–ª–æ –ø–∏—Å—å–º–æ –æ—Ç '—Å–ª—É–∂–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–∞–Ω–∫–∞' —Å –ø—Ä–æ—Å—å–±–æ–π –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑-–∑–∞ '–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏'. –°—Å—ã–ª–∫–∞ –≤–µ–¥–µ—Ç –Ω–∞ —Å–∞–π—Ç bank-secure-online.ru, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≥–ª—è–¥–∏—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ –Ω–∞—Å—Ç–æ—è—â–µ–º—É. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç–µ?",
                                    choices: [
                                        {
                                            text: "üîê –í–æ–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å - —Å–∞–π—Ç –≤—ã–≥–ª—è–¥–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ",
                                            feedback: "‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞! –≠—Ç–æ —Ñ–∏—à–∏–Ω–≥. –ú–æ—à–µ–Ω–Ω–∏–∫–∏ —Å–æ–∑–¥–∞—é—Ç —Ç–æ—á–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–∞–π—Ç–æ–≤. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–æ–º–µ–Ω –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ.",
                                            points: 0,
                                            correct: false,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üì± –û—Ç–∫—Ä—ã—Ç—å –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–∞–Ω–∫–∞",
                                            feedback: "‚úÖ –í–µ—Ä–Ω–æ! –ù–∞—Å—Ç–æ—è—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–∞–º –∏–∑ –ø–∏—Å–µ–º.",
                                            points: 18,
                                            correct: true,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å –ø–æ –Ω–æ–º–µ—Ä—É –∏–∑ –ø–∏—Å—å–º–∞",
                                            feedback: "‚ö†Ô∏è –û–ø–∞—Å–Ω–æ! –ù–æ–º–µ—Ä –≤ –ø–∏—Å—å–º–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —Å —Å–∞–π—Ç–∞ –±–∞–Ω–∫–∞.",
                                            points: 5,
                                            correct: false,
                                            next_node: "end"
                                        }
                                    ]
                                }
                            }
                        }
                    }
                ];
                
                const scenario = scenarios[(id - 1) % scenarios.length];
                return {
                    id: `case_${id}`,
                    title: scenario.title,
                    difficulty: "beginner",
                    ...scenario
                };
            }

            createIntermediateCase(id) {
                const scenarios = [
                    {
                        title: "–ê—Ä–±–∏—Ç—Ä–∞–∂ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç",
                        dialogue: {
                            start: "node_1",
                            nodes: {
                                "node_1": {
                                    question: "üìä –í–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç —É—á–∞—Å—Ç–∏–µ –≤ '–∞—Ä–±–∏—Ç—Ä–∞–∂–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ': –≤—ã –ø–µ—Ä–µ–≤–æ–¥–∏—Ç–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É –Ω–∞ –∫–æ—à–µ–ª–µ–∫, –∞ '—Ä–æ–±–æ—Ç' —Ç–æ—Ä–≥—É–µ—Ç –∏ –ø—Ä–∏–Ω–æ—Å–∏—Ç 5-10% –≤ –¥–µ–Ω—å. –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã '—É—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫' –¥—Ä—É–≥–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤. –í–∞—à —Ö–æ–¥?",
                                    choices: [
                                        {
                                            text: "üí∏ –í–ª–æ–∂–∏—Ç—å 0.1 BTC - —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ",
                                            feedback: "‚ùå –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–∏—Ä–∞–º–∏–¥–∞! –°–∫—Ä–∏–Ω—à–æ—Ç—ã –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å. –ù–∞—Å—Ç–æ—è—â–∏–π –∞—Ä–±–∏—Ç—Ä–∞–∂ —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–∏—Ö –∑–Ω–∞–Ω–∏–π –∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Ö–æ–¥.",
                                            points: 0,
                                            correct: false,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üîé –ü—Ä–æ–≤–µ—Ä–∏—Ç—å blockchain-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ '—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤'",
                                            feedback: "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –ù–∞—Å—Ç–æ—è—â–∏–µ —É—Å–ø–µ—Ö–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ blockchain-—ç–∫—Å–ø–ª–æ—Ä–µ—Ä—ã. –ú–æ—à–µ–Ω–Ω–∏–∫–∏ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.",
                                            points: 20,
                                            correct: true,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üíº –í–ª–æ–∂–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É –¥–ª—è —Ç–µ—Å—Ç–∞",
                                            feedback: "‚ö†Ô∏è –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ —Å—Ä–µ–¥—Å—Ç–≤! –î–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–µ —Å—É–º–º—ã –ª—É—á—à–µ –Ω–µ –¥–æ–≤–µ—Ä—è—Ç—å –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–∞–º.",
                                            points: 8,
                                            correct: false,
                                            next_node: "end"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    {
                        title: "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω–∂–µ–Ω–µ—Ä–∏—è –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö",
                        dialogue: {
                            start: "node_1",
                            nodes: {
                                "node_1": {
                                    question: "üë• –ö –≤–∞–º –≤ –¥—Ä—É–∑—å—è –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫, —É—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–π, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ IT-–∫–æ–º–ø–∞–Ω–∏–∏. –û–Ω –º–µ—Å—è—Ü –æ–±—â–∞–µ—Ç—Å—è, –¥–µ–ª–∏—Ç—Å—è '–ª–∏—á–Ω—ã–º–∏' —Ñ–æ—Ç–æ, –ø–æ—Ç–æ–º –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç '—É–Ω–∏–∫–∞–ª—å–Ω—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å' –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Å—Ç–∞—Ä—Ç–∞–ø. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç–µ?",
                                    choices: [
                                        {
                                            text: "ü§ù –î–æ–≤–µ—Ä–∏—Ç—å—Å—è - —á–µ–ª–æ–≤–µ–∫ –∫–∞–∂–µ—Ç—Å—è –∏—Å–∫—Ä–µ–Ω–Ω–∏–º",
                                            feedback: "‚ùå –û—Å—Ç–æ—Ä–æ–∂–Ω–æ! –≠—Ç–æ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ö–µ–º–∞ '–±—É—Ä–∏–º–µ'. –ú–æ—à–µ–Ω–Ω–∏–∫–∏ –º–µ—Å—è—Ü–∞–º–∏ —Å–æ–∑–¥–∞—é—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –∞—Ñ–µ—Ä.",
                                            points: 0,
                                            correct: false,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ —Ü–∏—Ñ—Ä–æ–≤–æ–π —Å–ª–µ–¥ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ",
                                            feedback: "‚úÖ –í–µ—Ä–Ω–æ! –ù–∞—Å—Ç–æ—è—â–∏–µ IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç –ø—Ä–æ—Ñ–∏–ª–∏ –Ω–∞ GitHub, LinkedIn. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ —Å–ª–µ–¥–∞ - –∫—Ä–∞—Å–Ω—ã–π —Ñ–ª–∞–≥.",
                                            points: 22,
                                            correct: true,
                                            next_node: "end"
                                        },
                                        {
                                            text: "üí¨ –°–ø—Ä–æ—Å–∏—Ç—å –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –æ —Å—Ç–∞—Ä—Ç–∞–ø–µ",
                                            feedback: "‚ö†Ô∏è –†–∏—Å–∫ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏! –ú–æ—à–µ–Ω–Ω–∏–∫–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã. –õ—É—á—à–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –æ–±—â–µ–Ω–∏–µ.",
                                            points: 7,
                                            correct: false,
                                            next_node: "end"
                                        }
                                    ]
                                }
                            }
                        }
                    }
                ];
                
                const scenario = scenarios[(id - 1) % scenarios.length];
                return {
                    id: `case_${id}`,
                    title: scenario.title,
                    difficulty: "intermediate",
                    ...scenario
                };
            }

            createAdvancedCase(id) {
                return {
                    id: `case_${id}`,
                    title: "CEO-—Ñ—Ä–æ–¥",
                    difficulty: "advanced",
                    dialogue: {
                        start: "node_1",
                        nodes: {
                            "node_1": {
                                question: "üè¢ –í—ã - —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä. –ü—Ä–∏—Ö–æ–¥–∏—Ç email –æ—Ç CEO —Å –ø—Ä–æ—Å—å–±–æ–π —Å—Ä–æ—á–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 500,000‚ÇΩ –Ω–∞ —Å—á–µ—Ç –Ω–æ–≤–æ–≥–æ '–ø–æ—Å—Ç–∞–≤—â–∏–∫–∞'. –ü–∏—Å—å–º–æ –ø—Ä–∏—à–ª–æ —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–æ—á—Ç—ã, —Ç–æ–Ω —Å—Ä–æ—á–Ω—ã–π. –ß—Ç–æ –¥–µ–ª–∞–µ—Ç–µ?",
                                choices: [
                                    {
                                        text: "üí≥ –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ - –ø–∏—Å—å–º–æ –æ—Ç –Ω–∞—á–∞–ª—å—Å—Ç–≤–∞",
                                        feedback: "‚ùå CEO-—Ñ—Ä–æ–¥! –ú–æ—à–µ–Ω–Ω–∏–∫–∏ –≤–∑–ª–∞–º—ã–≤–∞—é—Ç –ø–æ—á—Ç—É –∏–ª–∏ —Å–æ–∑–¥–∞—é—Ç –ø–æ—Ö–æ–∂–∏–µ –¥–æ–º–µ–Ω—ã. –í—Å–µ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è.",
                                        points: 0,
                                        correct: false,
                                        next_node: "end"
                                    },
                                    {
                                        text: "üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å CEO –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è",
                                        feedback: "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –õ—é–±—ã–µ –∫—Ä—É–ø–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã —Ç—Ä–µ–±—É—é—Ç –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–º—É –Ω–æ–º–µ—Ä—É.",
                                        points: 30,
                                        correct: true,
                                        next_node: "end"
                                    },
                                    {
                                        text: "üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —á–∞—Ç",
                                        feedback: "‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ! –ß–∞—Ç —Ç–æ–∂–µ –º–æ–≥—É—Ç –≤–∑–ª–æ–º–∞—Ç—å. –¢–æ–ª—å–∫–æ –ª–∏—á–Ω—ã–π –∑–≤–æ–Ω–æ–∫ –ø–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–º—É –Ω–æ–º–µ—Ä—É.",
                                        points: 10,
                                        correct: false,
                                        next_node: "end"
                                    }
                                ]
                            }
                        }
                    }
                };
            }

            createExpertCase(id) {
                return {
                    id: `case_${id}`,
                    title: "DeFi-–∞—Ñ–µ—Ä–∞",
                    difficulty: "expert",
                    dialogue: {
                        start: "node_1",
                        nodes: {
                            "node_1": {
                                question: "ü¶Ñ –í–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç —É—á–∞—Å—Ç–∏–µ –≤ '—Å–µ–∫—Ä–µ—Ç–Ω–æ–º' DeFi-–ø—É–ª–µ —Å APY 1000%. –ö–æ–Ω—Ç—Ä–∞–∫—Ç –ø—Ä–æ—à–µ–ª '–∞—É–¥–∏—Ç', —Å–∞–π—Ç –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ. –î–ª—è —É—á–∞—Å—Ç–∏—è –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ETH –Ω–∞ —Å–º–∞—Ä—Ç-–∫–æ–Ω—Ç—Ä–∞–∫—Ç. –í–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è?",
                                choices: [
                                    {
                                        text: "üöÄ –ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å - APY —Å–ª–∏—à–∫–æ–º –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π",
                                        feedback: "‚ùå Rug pull! –í—ã—Å–æ–∫–∏–π APY —á–∞—Å—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ –º–æ—à–µ–Ω–Ω–∏–∫–æ–≤. –í–∞—à–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –±—É–¥—É—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã.",
                                        points: 0,
                                        correct: false,
                                        next_node: "end"
                                    },
                                    {
                                        text: "üî¨ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç –≤ Etherscan –∏ –∞—É–¥–∏—Ç",
                                        feedback: "‚úÖ –í–µ—Ä–Ω–æ! –ù–∞—Å—Ç–æ—è—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –∏–º–µ—é—Ç –ø—É–±–ª–∏—á–Ω—ã–π –∫–æ–¥ –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∞—É–¥–∏—Ç—ã. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—Ç–∑—ã–≤—ã –∞—É–¥–∏—Ç–æ—Ä–æ–≤.",
                                        points: 35,
                                        correct: true,
                                        next_node: "end"
                                    },
                                    {
                                        text: "üíß –í–ª–æ–∂–∏—Ç—å 0.01 ETH –¥–ª—è —Ç–µ—Å—Ç–∞",
                                        feedback: "‚ö†Ô∏è –í—Å–µ —Ä–∞–≤–Ω–æ —Ä–∏—Å–∫! –î–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–µ —Å—É–º–º—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω—ã –≤ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö –ø—É–ª–∞—Ö.",
                                        points: 12,
                                        correct: false,
                                        next_node: "end"
                                    }
                                ]
                            }
                        }
                    }
                };
            }

            showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
            }

            showMainMenu() {
                this.updatePlayerStats();
                this.showScreen('mainMenu');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                const startBtn = document.getElementById('startGameBtn');
                if (this.playerData.completedCases.length === 0) {
                    startBtn.innerHTML = '<span class="btn-icon">üéÆ</span>–ù–∞—á–∞—Ç—å –∏–≥—Ä—É';
                } else {
                    startBtn.innerHTML = '<span class="btn-icon">üéÆ</span>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É';
                }
            }

            updatePlayerStats() {
                document.getElementById('totalScore').textContent = this.playerData.totalScore;
                document.getElementById('accuracy').textContent = `${this.playerData.accuracy}%`;
                document.getElementById('streak').textContent = this.playerData.currentStreak;

                const completed = this.playerData.completedCases.length;
                const progress = (completed / 100) * 100;
                document.getElementById('progressFill').style.width = `${progress}%`;
                document.getElementById('progressText').textContent = `${completed}/100`;

                this.updatePlayerBadge();
            }

            updatePlayerBadge() {
                const completed = this.playerData.completedCases.length;
                let badge = { emoji: 'üü¢', text: '–ù–æ–≤–∏—á–æ–∫' };

                if (completed >= 71) {
                    badge = { emoji: 'üî¥', text: '–ú–∞—Å—Ç–µ—Ä' };
                } else if (completed >= 31) {
                    badge = { emoji: 'üü£', text: '–≠–∫—Å–ø–µ—Ä—Ç' };
                } else if (completed >= 11) {
                    badge = { emoji: 'üîµ', text: '–î–µ—Ç–µ–∫—Ç–∏–≤' };
                }

                document.querySelector('.badge-emoji').textContent = badge.emoji;
                document.querySelector('.badge-text').textContent = badge.text;
            }

            startGame() {
                let nextCase;
                
                // –ù–∞—Ö–æ–¥–∏–º —Å–ª–µ–¥—É—é—â–∏–π –Ω–µ–ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π –∫–µ–π—Å
                if (this.playerData.lastPlayedCase) {
                    const lastIndex = this.cases.findIndex(c => c.id === this.playerData.lastPlayedCase);
                    nextCase = this.cases[lastIndex + 1] || this.cases.find(c => !this.playerData.completedCases.includes(c.id));
                } else {
                    nextCase = this.cases.find(c => !this.playerData.completedCases.includes(c.id));
                }
                
                if (nextCase) {
                    this.startCase(nextCase);
                } else {
                    tg.showPopup({
                        title: 'üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!',
                        message: '–í—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ –∫–µ–π—Å—ã!',
                        buttons: [{ type: 'ok' }]
                    });
                }
            }

            showCasesScreen() {
                this.showScreen('casesScreen');
                this.renderCasesGrid();
            }

            renderCasesGrid() {
                const grid = document.getElementById('casesGrid');
                grid.innerHTML = '';

                this.cases.forEach((caseItem, index) => {
                    const isCompleted = this.playerData.completedCases.includes(caseItem.id);
                    const isCurrent = !isCompleted && (
                        index === 0 || 
                        this.playerData.completedCases.includes(this.cases[index - 1].id)
                    );

                    const caseElement = document.createElement('div');
                    caseElement.className = `case-item ${isCompleted ? 'completed' : ''} ${isCurrent ? 'current' : ''} ${!isCompleted && !isCurrent ? 'locked' : ''}`;
                    caseElement.innerHTML = `
                        <div class="case-number">${index + 1}</div>
                        <div class="case-difficulty difficulty-${caseItem.difficulty}">
                            ${this.getDifficultyText(caseItem.difficulty)}
                        </div>
                    `;

                    if (!isCompleted && (isCurrent || isCompleted)) {
                        caseElement.addEventListener('click', () => this.startCase(caseItem));
                    }

                    grid.appendChild(caseElement);
                });
            }

            getDifficultyText(difficulty) {
                const texts = {
                    'beginner': '–ù–æ–≤–∏—á–æ–∫',
                    'intermediate': '–°—Ä–µ–¥–Ω–∏–π',
                    'advanced': '–ü—Ä–æ–¥–≤.',
                    'expert': '–≠–∫—Å–ø–µ—Ä—Ç'
                };
                return texts[difficulty] || difficulty;
            }

            startCase(caseItem) {
                this.currentCase = caseItem;
                this.currentNode = caseItem.dialogue.start;
                this.showScreen('gameScreen');
                this.updateGameUI();
            }

            updateGameUI() {
                if (!this.currentCase || !this.currentNode) return;

                const node = this.currentCase.dialogue.nodes[this.currentNode];
                const caseIndex = this.cases.findIndex(c => c.id === this.currentCase.id) + 1;
                
                document.getElementById('caseTitle').textContent = this.currentCase.title;
                document.getElementById('caseDifficulty').textContent = this.getDifficultyText(this.currentCase.difficulty);
                document.getElementById('caseDifficulty').className = `difficulty-badge difficulty-${this.currentCase.difficulty}`;
                document.getElementById('caseNumber').textContent = `#${caseIndex}`;
                document.getElementById('dialogueText').textContent = node.question;

                const choicesContainer = document.getElementById('choicesContainer');
                choicesContainer.innerHTML = '';

                node.choices.forEach((choice) => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.textContent = choice.text;
                    button.addEventListener('click', () => this.makeChoice(choice));
                    choicesContainer.appendChild(button);
                });

                document.getElementById('feedbackContainer').classList.add('hidden');
                document.getElementById('nextCaseBtn').classList.add('hidden');
                this.updateCurrentGameStats();
            }

            makeChoice(choice) {
                this.currentChoice = choice;
                this.showFeedback(choice);
                this.updatePlayerStatsAfterChoice(choice);
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞
                document.querySelectorAll('.choice-btn').forEach(btn => {
                    btn.style.pointerEvents = 'none';
                });

                if (choice.next_node && choice.next_node !== 'end') {
                    setTimeout(() => {
                        this.currentNode = choice.next_node;
                        this.updateGameUI();
                    }, 2000);
                } else {
                    setTimeout(() => {
                        this.completeCase();
                        document.getElementById('nextCaseBtn').classList.remove('hidden');
                    }, 1500);
                }
            }

            showFeedback(choice) {
                const feedbackContainer = document.getElementById('feedbackContainer');
                const feedbackContent = document.getElementById('feedbackContent');
                
                feedbackContent.className = 'feedback-content';
                if (choice.correct) {
                    feedbackContent.classList.add('correct');
                } else if (choice.points > 0) {
                    feedbackContent.classList.add('partial');
                } else {
                    feedbackContent.classList.add('incorrect');
                }

                document.getElementById('feedbackIcon').textContent = choice.correct ? '‚úÖ' : '‚ùå';
                document.getElementById('feedbackTitle').textContent = choice.correct ? '–ü—Ä–∞–≤–∏–ª—å–Ω–æ!' : '–û—à–∏–±–∫–∞';
                document.getElementById('feedbackText').textContent = choice.feedback;

                feedbackContainer.classList.remove('hidden');
                feedbackContainer.classList.add('show');
            }

            updatePlayerStatsAfterChoice(choice) {
                this.playerData.totalScore += choice.points;

                if (choice.correct) {
                    this.playerData.currentStreak++;
                    this.playerData.maxStreak = Math.max(this.playerData.maxStreak, this.playerData.currentStreak);
                } else {
                    this.playerData.currentStreak = 0;
                }

                this.savePlayerData();
                this.updateCurrentGameStats();
            }

            updateCurrentGameStats() {
                document.getElementById('currentScore').textContent = this.playerData.totalScore;
                document.getElementById('currentStreak').textContent = this.playerData.currentStreak;
            }

            completeCase() {
                if (this.currentCase && !this.playerData.completedCases.includes(this.currentCase.id)) {
                    this.playerData.completedCases.push(this.currentCase.id);
                    this.playerData.lastPlayedCase = this.currentCase.id;
                    
                    const difficulty = this.currentCase.difficulty;
                    this.playerData.stats[difficulty].completed++;
                    
                    if (this.currentChoice.correct) {
                        this.playerData.stats[difficulty].correct++;
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å
                    const totalCompleted = Object.values(this.playerData.stats).reduce((sum, stat) => sum + stat.completed, 0);
                    const totalCorrect = Object.values(this.playerData.stats).reduce((sum, stat) => sum + stat.correct, 0);
                    this.playerData.accuracy = totalCompleted > 0 ? Math.round((totalCorrect / totalCompleted) * 100) : 0;
                    
                    this.savePlayerData();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                    this.checkAchievements();
                }
            }

            nextCase() {
                const currentIndex = this.cases.findIndex(c => c.id === this.currentCase.id);
                const nextCase = this.cases[currentIndex + 1];
                
                if (nextCase && !this.playerData.completedCases.includes(nextCase.id)) {
                    this.startCase(nextCase);
                } else {
                    this.showMainMenu();
                }
            }

            showStatsScreen() {
                this.showScreen('statsScreen');
                this.updateStatsDisplay();
            }

            updateStatsDisplay() {
                const stats = this.playerData.stats;
                const completed = this.playerData.completedCases.length;
                
                document.getElementById('statTotalScore').textContent = this.playerData.totalScore;
                document.getElementById('statCasesCompleted').textContent = completed;
                document.getElementById('statAccuracy').textContent = `${this.playerData.accuracy}%`;
                document.getElementById('statMaxStreak').textContent = this.playerData.maxStreak;

                document.getElementById('statBeginner').textContent = `${stats.beginner.completed}/20`;
                document.getElementById('statIntermediate').textContent = `${stats.intermediate.completed}/30`;
                document.getElementById('statAdvanced').textContent = `${stats.advanced.completed}/30`;
                document.getElementById('statExpert').textContent = `${stats.expert.completed}/20`;
            }

            showAchievementsScreen() {
                this.showScreen('achievementsScreen');
                this.renderAchievements();
            }

            renderAchievements() {
                const achievements = [
                    { id: 'first_case', name: '–ü–µ—Ä–≤—ã–π –∫–µ–π—Å', desc: '–ü—Ä–æ–π–¥–∏—Ç–µ –ø–µ—Ä–≤—ã–π –∫–µ–π—Å', icon: 'üéÆ' },
                    { id: 'beginner_master', name: '–ú–∞—Å—Ç–µ—Ä –Ω–æ–≤–∏—á–∫–∞', desc: '–ü—Ä–æ–π–¥–∏—Ç–µ –≤—Å–µ –∫–µ–π—Å—ã –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤', icon: 'üü¢' },
                    { id: 'streak_5', name: '–°–µ—Ä–∏—è –ø–æ–±–µ–¥', desc: '5 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–¥—Ä—è–¥', icon: 'üî•' },
                    { id: 'detective', name: '–î–µ—Ç–µ–∫—Ç–∏–≤', desc: '–ü—Ä–æ–π–¥–∏—Ç–µ 30 –∫–µ–π—Å–æ–≤', icon: 'üîç' },
                    { id: 'expert', name: '–≠–∫—Å–ø–µ—Ä—Ç', desc: '–ü—Ä–æ–π–¥–∏—Ç–µ 50 –∫–µ–π—Å–æ–≤', icon: 'üéì' },
                    { id: 'master', name: '–ú–∞—Å—Ç–µ—Ä', desc: '–ü—Ä–æ–π–¥–∏—Ç–µ –≤—Å–µ 100 –∫–µ–π—Å–æ–≤', icon: 'üèÜ' },
                    { id: 'perfect_10', name: '–ò–¥–µ–∞–ª—å–Ω–∞—è –¥–µ—Å—è—Ç–∫–∞', desc: '10 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–¥—Ä—è–¥', icon: '‚≠ê' },
                    { id: 'crypto_savvy', name: '–ö—Ä–∏–ø—Ç–æ-–∑–Ω–∞—Ç–æ–∫', desc: '–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∏—Ç–µ –≤—Å–µ –∫—Ä–∏–ø—Ç–æ-–∫–µ–π—Å—ã', icon: '‚Çø' }
                ];

                const grid = document.getElementById('achievementsGrid');
                grid.innerHTML = '';

                achievements.forEach(achievement => {
                    const isUnlocked = this.checkAchievementUnlocked(achievement.id);
                    
                    const achievementElement = document.createElement('div');
                    achievementElement.className = `achievement-item ${isUnlocked ? 'unlocked' : ''}`;
                    achievementElement.innerHTML = `
                        <div class="achievement-icon">${achievement.icon}</div>
                        <div class="achievement-info">
                            <div class="achievement-name">${achievement.name}</div>
                            <div class="achievement-desc">${achievement.desc}</div>
                        </div>
                        <div class="achievement-status">${isUnlocked ? '‚úÖ' : 'üîí'}</div>
                    `;
                    
                    grid.appendChild(achievementElement);
                });
            }

            checkAchievementUnlocked(achievementId) {
                const completed = this.playerData.completedCases.length;
                const cryptoCases = this.playerData.completedCases.filter(id => 
                    id.includes('case_1') || id.includes('case_21') || id.includes('case_81')
                );
                
                switch(achievementId) {
                    case 'first_case': return completed >= 1;
                    case 'beginner_master': return this.playerData.stats.beginner.completed >= 20;
                    case 'streak_5': return this.playerData.maxStreak >= 5;
                    case 'detective': return completed >= 30;
                    case 'expert': return completed >= 50;
                    case 'master': return completed >= 100;
                    case 'perfect_10': return this.playerData.maxStreak >= 10;
                    case 'crypto_savvy': return cryptoCases.length >= 3;
                    default: return false;
                }
            }

            checkAchievements() {
                const achievements = ['first_case', 'beginner_master', 'streak_5', 'detective', 'expert', 'master', 'perfect_10', 'crypto_savvy'];
                let newAchievements = [];

                achievements.forEach(achievementId => {
                    if (this.checkAchievementUnlocked(achievementId) && !this.playerData.achievements.includes(achievementId)) {
                        this.playerData.achievements.push(achievementId);
                        newAchievements.push(achievementId);
                    }
                });

                if (newAchievements.length > 0) {
                    this.savePlayerData();
                    this.showAchievementPopup(newAchievements);
                }
            }

            showAchievementPopup(achievementIds) {
                const achievementNames = {
                    'first_case': '–ü–µ—Ä–≤—ã–π –∫–µ–π—Å',
                    'beginner_master': '–ú–∞—Å—Ç–µ—Ä –Ω–æ–≤–∏—á–∫–∞', 
                    'streak_5': '–°–µ—Ä–∏—è –ø–æ–±–µ–¥',
                    'detective': '–î–µ—Ç–µ–∫—Ç–∏–≤',
                    'expert': '–≠–∫—Å–ø–µ—Ä—Ç',
                    'master': '–ú–∞—Å—Ç–µ—Ä',
                    'perfect_10': '–ò–¥–µ–∞–ª—å–Ω–∞—è –¥–µ—Å—è—Ç–∫–∞',
                    'crypto_savvy': '–ö—Ä–∏–ø—Ç–æ-–∑–Ω–∞—Ç–æ–∫'
                };

                const message = achievementIds.map(id => `üèÜ ${achievementNames[id]}`).join('\n');
                
                tg.showPopup({
                    title: 'üéâ –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!',
                    message: message,
                    buttons: [{ type: 'ok' }]
                });
            }

            async shareResults() {
                const user = tg.initDataUnsafe?.user;
                const completed = this.playerData.completedCases.length;
                const message = `üïµÔ∏è‚Äç‚ôÇÔ∏è <b>–ú–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Scam Hunter!</b>\n\n` +
                               `üë§ –ò–≥—Ä–æ–∫: ${user?.first_name || '–ê–Ω–æ–Ω–∏–º'}\n` +
                               `üèÜ –û—á–∫–∏: ${this.playerData.totalScore}\n` +
                               `üìä –ü—Ä–æ–π–¥–µ–Ω–æ –∫–µ–π—Å–æ–≤: ${completed}/100\n` +
                               `üéØ –¢–æ—á–Ω–æ—Å—Ç—å: ${this.playerData.accuracy}%\n` +
                               `üî• –õ—É—á—à–∞—è —Å–µ—Ä–∏—è: ${this.playerData.maxStreak}\n\n` +
                               `üéÆ <i>–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –¥–µ—Ç–µ–∫—Ç–∏–≤–∞ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞!</i>`;

                try {
                    const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: user?.id || '123456',
                            text: message,
                            parse_mode: 'HTML'
                        })
                    });
                    
                    if (response.ok) {
                        tg.showPopup({
                            title: '‚úÖ –£—Å–ø–µ—à–Ω–æ!',
                            message: '–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram',
                            buttons: [{ type: 'ok' }]
                        });
                    }
                } catch (error) {
                    tg.showPopup({
                        title: 'üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è',
                        message: message.replace(/<[^>]*>/g, ''),
                        buttons: [{ type: 'ok' }]
                    });
                }
            }
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            window.game = new ScamHunterGame();
        });
    </script>
</body>
</html>
